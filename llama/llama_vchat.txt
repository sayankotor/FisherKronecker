{'lm_head': 1, 'model.layers.31.mlp.gate_proj': 0.8, 'model.layers.31.mlp.up_proj': 0.8, 'model.layers.31.mlp.down_proj': 0.8, 'model.layers.31.self_attn.q_proj': 1, 'model.layers.31.self_attn.k_proj': 1, 'model.layers.31.self_attn.v_proj': 1, 'model.layers.31.self_attn.o_proj': 1, 'model.layers.30.mlp.gate_proj': 0.8, 'model.layers.30.mlp.up_proj': 0.8, 'model.layers.30.mlp.down_proj': 0.8, 'model.layers.30.self_attn.q_proj': 1, 'model.layers.30.self_attn.k_proj': 1, 'model.layers.30.self_attn.v_proj': 1, 'model.layers.30.self_attn.o_proj': 1, 'model.layers.29.mlp.gate_proj': 0.8, 'model.layers.29.mlp.up_proj': 0.8, 'model.layers.29.mlp.down_proj': 0.8, 'model.layers.29.self_attn.q_proj': 1, 'model.layers.29.self_attn.k_proj': 1, 'model.layers.29.self_attn.v_proj': 1, 'model.layers.29.self_attn.o_proj': 1, 'model.layers.28.mlp.gate_proj': 0.8, 'model.layers.28.mlp.up_proj': 0.8, 'model.layers.28.mlp.down_proj': 0.8, 'model.layers.28.self_attn.q_proj': 1, 'model.layers.28.self_attn.k_proj': 1, 'model.layers.28.self_attn.v_proj': 1, 'model.layers.28.self_attn.o_proj': 1, 'model.layers.27.mlp.gate_proj': 0.8, 'model.layers.27.mlp.up_proj': 0.8, 'model.layers.27.mlp.down_proj': 0.8, 'model.layers.27.self_attn.q_proj': 1, 'model.layers.27.self_attn.k_proj': 1, 'model.layers.27.self_attn.v_proj': 1, 'model.layers.27.self_attn.o_proj': 1, 'model.layers.26.mlp.gate_proj': 0.8, 'model.layers.26.mlp.up_proj': 0.8, 'model.layers.26.mlp.down_proj': 0.8, 'model.layers.26.self_attn.q_proj': 1, 'model.layers.26.self_attn.k_proj': 1, 'model.layers.26.self_attn.v_proj': 1, 'model.layers.26.self_attn.o_proj': 1, 'model.layers.25.mlp.gate_proj': 0.8, 'model.layers.25.mlp.up_proj': 0.8, 'model.layers.25.mlp.down_proj': 0.8, 'model.layers.25.self_attn.q_proj': 1, 'model.layers.25.self_attn.k_proj': 1, 'model.layers.25.self_attn.v_proj': 1, 'model.layers.25.self_attn.o_proj': 1, 'model.layers.24.mlp.gate_proj': 0.8, 'model.layers.24.mlp.up_proj': 0.8, 'model.layers.24.mlp.down_proj': 0.8, 'model.layers.24.self_attn.q_proj': 1, 'model.layers.24.self_attn.k_proj': 1, 'model.layers.24.self_attn.v_proj': 1, 'model.layers.24.self_attn.o_proj': 1, 'model.layers.23.mlp.gate_proj': 0.8, 'model.layers.23.mlp.up_proj': 0.8, 'model.layers.23.mlp.down_proj': 0.8, 'model.layers.23.self_attn.q_proj': 1, 'model.layers.23.self_attn.k_proj': 1, 'model.layers.23.self_attn.v_proj': 1, 'model.layers.23.self_attn.o_proj': 1, 'model.layers.22.mlp.gate_proj': 0.8, 'model.layers.22.mlp.up_proj': 0.8, 'model.layers.22.mlp.down_proj': 0.8, 'model.layers.22.self_attn.q_proj': 1, 'model.layers.22.self_attn.k_proj': 1, 'model.layers.22.self_attn.v_proj': 1, 'model.layers.22.self_attn.o_proj': 1, 'model.layers.21.mlp.gate_proj': 0.8, 'model.layers.21.mlp.up_proj': 0.8, 'model.layers.21.mlp.down_proj': 0.8, 'model.layers.21.self_attn.q_proj': 1, 'model.layers.21.self_attn.k_proj': 1, 'model.layers.21.self_attn.v_proj': 1, 'model.layers.21.self_attn.o_proj': 1, 'model.layers.20.mlp.gate_proj': 0.8, 'model.layers.20.mlp.up_proj': 0.8, 'model.layers.20.mlp.down_proj': 0.8, 'model.layers.20.self_attn.q_proj': 1, 'model.layers.20.self_attn.k_proj': 1, 'model.layers.20.self_attn.v_proj': 1, 'model.layers.20.self_attn.o_proj': 1, 'model.layers.19.mlp.gate_proj': 0.8, 'model.layers.19.mlp.up_proj': 0.8, 'model.layers.19.mlp.down_proj': 0.8, 'model.layers.19.self_attn.q_proj': 1, 'model.layers.19.self_attn.k_proj': 1, 'model.layers.19.self_attn.v_proj': 1, 'model.layers.19.self_attn.o_proj': 1, 'model.layers.18.mlp.gate_proj': 0.8, 'model.layers.18.mlp.up_proj': 0.8, 'model.layers.18.mlp.down_proj': 0.8, 'model.layers.18.self_attn.q_proj': 1, 'model.layers.18.self_attn.k_proj': 1, 'model.layers.18.self_attn.v_proj': 1, 'model.layers.18.self_attn.o_proj': 1, 'model.layers.17.mlp.gate_proj': 0.8, 'model.layers.17.mlp.up_proj': 0.8, 'model.layers.17.mlp.down_proj': 0.8, 'model.layers.17.self_attn.q_proj': 1, 'model.layers.17.self_attn.k_proj': 1, 'model.layers.17.self_attn.v_proj': 1, 'model.layers.17.self_attn.o_proj': 1, 'model.layers.16.mlp.gate_proj': 0.8, 'model.layers.16.mlp.up_proj': 0.8, 'model.layers.16.mlp.down_proj': 0.8, 'model.layers.16.self_attn.q_proj': 1, 'model.layers.16.self_attn.k_proj': 1, 'model.layers.16.self_attn.v_proj': 1, 'model.layers.16.self_attn.o_proj': 1, 'model.layers.15.mlp.gate_proj': 0.8, 'model.layers.15.mlp.up_proj': 0.8, 'model.layers.15.mlp.down_proj': 0.8, 'model.layers.15.self_attn.q_proj': 1, 'model.layers.15.self_attn.k_proj': 1, 'model.layers.15.self_attn.v_proj': 1, 'model.layers.15.self_attn.o_proj': 1, 'model.layers.14.mlp.gate_proj': 0.8, 'model.layers.14.mlp.up_proj': 0.8, 'model.layers.14.mlp.down_proj': 0.8, 'model.layers.14.self_attn.q_proj': 1, 'model.layers.14.self_attn.k_proj': 1, 'model.layers.14.self_attn.v_proj': 1, 'model.layers.14.self_attn.o_proj': 1, 'model.layers.13.mlp.gate_proj': 0.8, 'model.layers.13.mlp.up_proj': 0.8, 'model.layers.13.mlp.down_proj': 0.8, 'model.layers.13.self_attn.q_proj': 1, 'model.layers.13.self_attn.k_proj': 1, 'model.layers.13.self_attn.v_proj': 1, 'model.layers.13.self_attn.o_proj': 1, 'model.layers.12.mlp.gate_proj': 0.8, 'model.layers.12.mlp.up_proj': 0.8, 'model.layers.12.mlp.down_proj': 0.8, 'model.layers.12.self_attn.q_proj': 1, 'model.layers.12.self_attn.k_proj': 1, 'model.layers.12.self_attn.v_proj': 1, 'model.layers.12.self_attn.o_proj': 1, 'model.layers.11.mlp.gate_proj': 0.8, 'model.layers.11.mlp.up_proj': 0.8, 'model.layers.11.mlp.down_proj': 0.8, 'model.layers.11.self_attn.q_proj': 1, 'model.layers.11.self_attn.k_proj': 1, 'model.layers.11.self_attn.v_proj': 1, 'model.layers.11.self_attn.o_proj': 1, 'model.layers.10.mlp.gate_proj': 0.8, 'model.layers.10.mlp.up_proj': 0.8, 'model.layers.10.mlp.down_proj': 0.8, 'model.layers.10.self_attn.q_proj': 1, 'model.layers.10.self_attn.k_proj': 1, 'model.layers.10.self_attn.v_proj': 1, 'model.layers.10.self_attn.o_proj': 1, 'model.layers.9.mlp.gate_proj': 0.8, 'model.layers.9.mlp.up_proj': 0.8, 'model.layers.9.mlp.down_proj': 0.8, 'model.layers.9.self_attn.q_proj': 1, 'model.layers.9.self_attn.k_proj': 1, 'model.layers.9.self_attn.v_proj': 1, 'model.layers.9.self_attn.o_proj': 1, 'model.layers.8.mlp.gate_proj': 0.8, 'model.layers.8.mlp.up_proj': 0.8, 'model.layers.8.mlp.down_proj': 0.8, 'model.layers.8.self_attn.q_proj': 1, 'model.layers.8.self_attn.k_proj': 1, 'model.layers.8.self_attn.v_proj': 1, 'model.layers.8.self_attn.o_proj': 1, 'model.layers.7.mlp.gate_proj': 0.8, 'model.layers.7.mlp.up_proj': 0.8, 'model.layers.7.mlp.down_proj': 0.8, 'model.layers.7.self_attn.q_proj': 1, 'model.layers.7.self_attn.k_proj': 1, 'model.layers.7.self_attn.v_proj': 1, 'model.layers.7.self_attn.o_proj': 1, 'model.layers.6.mlp.gate_proj': 0.8, 'model.layers.6.mlp.up_proj': 0.8, 'model.layers.6.mlp.down_proj': 0.8, 'model.layers.6.self_attn.q_proj': 1, 'model.layers.6.self_attn.k_proj': 1, 'model.layers.6.self_attn.v_proj': 1, 'model.layers.6.self_attn.o_proj': 1, 'model.layers.5.mlp.gate_proj': 0.8, 'model.layers.5.mlp.up_proj': 0.8, 'model.layers.5.mlp.down_proj': 0.8, 'model.layers.5.self_attn.q_proj': 1, 'model.layers.5.self_attn.k_proj': 1, 'model.layers.5.self_attn.v_proj': 1, 'model.layers.5.self_attn.o_proj': 1, 'model.layers.4.mlp.gate_proj': 0.8, 'model.layers.4.mlp.up_proj': 0.8, 'model.layers.4.mlp.down_proj': 0.8, 'model.layers.4.self_attn.q_proj': 1, 'model.layers.4.self_attn.k_proj': 1, 'model.layers.4.self_attn.v_proj': 1, 'model.layers.4.self_attn.o_proj': 1, 'model.layers.3.mlp.gate_proj': 0.8, 'model.layers.3.mlp.up_proj': 0.8, 'model.layers.3.mlp.down_proj': 0.8, 'model.layers.3.self_attn.q_proj': 1, 'model.layers.3.self_attn.k_proj': 1, 'model.layers.3.self_attn.v_proj': 1, 'model.layers.3.self_attn.o_proj': 1, 'model.layers.2.mlp.gate_proj': 0.8, 'model.layers.2.mlp.up_proj': 0.8, 'model.layers.2.mlp.down_proj': 0.8, 'model.layers.2.self_attn.q_proj': 1, 'model.layers.2.self_attn.k_proj': 1, 'model.layers.2.self_attn.v_proj': 1, 'model.layers.2.self_attn.o_proj': 1, 'model.layers.1.mlp.gate_proj': 0.8, 'model.layers.1.mlp.up_proj': 0.8, 'model.layers.1.mlp.down_proj': 0.8, 'model.layers.1.self_attn.q_proj': 1, 'model.layers.1.self_attn.k_proj': 1, 'model.layers.1.self_attn.v_proj': 1, 'model.layers.1.self_attn.o_proj': 1, 'model.layers.0.mlp.gate_proj': 0.8, 'model.layers.0.mlp.up_proj': 0.8, 'model.layers.0.mlp.down_proj': 0.8, 'model.layers.0.self_attn.q_proj': 1, 'model.layers.0.self_attn.k_proj': 1, 'model.layers.0.self_attn.v_proj': 1, 'model.layers.0.self_attn.o_proj': 1}2025-04-25 08:22:33,006 - INFO - Loading model: unsloth/llama-2-7b[2025-04-25 08:22:37,140] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)Warning: The cache directory for DeepSpeed Triton autotune, /home/jovyan/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.Loading checkpoint shards:   0%|                                            | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|████████████                        | 1/3 [00:12<00:24, 12.48s/it]Loading checkpoint shards:  67%|████████████████████████            | 2/3 [00:25<00:12, 12.63s/it]Loading checkpoint shards: 100%|████████████████████████████████████| 3/3 [00:34<00:00, 10.90s/it]Loading checkpoint shards: 100%|████████████████████████████████████| 3/3 [00:34<00:00, 11.35s/it]2025-04-25 08:23:14,007 - INFO - Model loaded with dtype torch.bfloat162025-04-25 08:23:35,327 - INFO - Model moved to cuda:02025-04-25 08:23:35,329 - INFO - Found 225 linear layers to potentially compress.Compressing Layers:   0%|                                                 | 0/225 [00:00<?, ?it/s]2025-04-25 08:23:35,330 - INFO - Skipping layer model.layers.0.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:23:35,330 - INFO - Skipping layer model.layers.0.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:23:35,330 - INFO - Skipping layer model.layers.0.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:23:35,330 - INFO - Skipping layer model.layers.0.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:23:35,330 - INFO - Layer: model.layers.0.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:23:35,334 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_0_mlp_gate_proj.safetensors2025-04-25 08:23:35,334 - INFO - exists: True2025-04-25 08:23:35,336 - INFO - factorize_layer_kron_svd2025-04-25 08:23:37,241 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:23:39,030 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 08:23:41,997 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:23:47,158 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_0_mlp_gate_proj.safetensors TrueLayer: model.layers.0.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.6283903e-04 8.6134132e-05 3.3411572e-05 1.4365877e-05 1.1889796e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:25:13,166 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:25:13,166 - INFO - Replacing 'model.layers.0.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:   2%|▊                                      | 5/225 [01:37<1:11:44, 19.57s/it]2025-04-25 08:25:13,167 - INFO - Layer: model.layers.0.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:25:13,170 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_0_mlp_up_proj.safetensors2025-04-25 08:25:13,170 - INFO - exists: True2025-04-25 08:25:13,193 - INFO - factorize_layer_kron_svd2025-04-25 08:25:15,137 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:25:16,927 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 08:25:20,431 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:25:25,531 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_0_mlp_up_proj.safetensors TrueLayer: model.layers.0.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [2.1336577e-04 7.0837305e-05 5.0806619e-05 3.5073226e-05 2.8848666e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:26:52,063 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:26:52,064 - INFO - Replacing 'model.layers.0.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:   3%|█                                      | 6/225 [03:16<2:15:45, 37.20s/it]2025-04-25 08:26:52,064 - INFO - Layer: model.layers.0.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:26:52,067 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_0_mlp_down_proj.safetensors2025-04-25 08:26:52,068 - INFO - exists: True2025-04-25 08:26:52,091 - INFO - factorize_layer_kron_svd2025-04-25 08:26:55,600 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:27:00,230 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:27:05,217 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 08:27:06,827 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:27:08,558 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_0_mlp_down_proj.safetensors TrueLayer: model.layers.0.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [0.00360306 0.00047922 0.00020495 0.00012077 0.00011648]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 08:28:54,931 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 08:28:54,931 - INFO - Replacing 'model.layers.0.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:   3%|█▏                                     | 7/225 [05:19<3:30:09, 57.84s/it]2025-04-25 08:28:54,932 - INFO - Skipping layer model.layers.1.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:28:54,932 - INFO - Skipping layer model.layers.1.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:28:54,932 - INFO - Skipping layer model.layers.1.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:28:54,932 - INFO - Skipping layer model.layers.1.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:28:54,932 - INFO - Layer: model.layers.1.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:28:54,936 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_1_mlp_gate_proj.safetensors2025-04-25 08:28:54,936 - INFO - exists: True2025-04-25 08:28:54,960 - INFO - factorize_layer_kron_svd2025-04-25 08:28:56,851 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:28:58,750 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:29:00,568 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 08:29:05,289 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_1_mlp_gate_proj.safetensors TrueLayer: model.layers.1.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [2.5756116e-04 2.0590833e-05 1.7721311e-05 1.4897597e-05 1.3294670e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:30:30,160 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:30:30,161 - INFO - Replacing 'model.layers.1.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:   5%|██                                    | 12/225 [06:54<1:58:13, 33.30s/it]2025-04-25 08:30:30,161 - INFO - Layer: model.layers.1.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:30:30,175 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_1_mlp_up_proj.safetensors2025-04-25 08:30:30,175 - INFO - exists: True2025-04-25 08:30:30,224 - INFO - factorize_layer_kron_svd2025-04-25 08:30:32,015 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:30:33,468 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:30:34,911 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:30:36,367 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:30:37,856 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:30:39,549 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:30:41,864 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:30:44,387 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:30:46,943 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:30:49,514 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:30:52,596 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:30:57,687 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_1_mlp_up_proj.safetensors TrueLayer: model.layers.1.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [7.3754545e-06 4.6838541e-06 4.6829132e-06 4.5144598e-06 4.4679359e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:32:26,449 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:32:26,449 - INFO - Replacing 'model.layers.1.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:   6%|██▏                                   | 13/225 [08:51<2:42:32, 46.00s/it]2025-04-25 08:32:26,450 - INFO - Layer: model.layers.1.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:32:26,453 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_1_mlp_down_proj.safetensors2025-04-25 08:32:26,454 - INFO - exists: True2025-04-25 08:32:26,477 - INFO - factorize_layer_kron_svd2025-04-25 08:32:29,608 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:32:35,055 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 08:32:36,491 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:32:38,321 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_1_mlp_down_proj.safetensors TrueLayer: model.layers.1.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [6.6591608e-03 3.2780811e-04 2.1277647e-04 7.6709446e-05 6.4770218e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 08:34:18,494 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 08:34:18,494 - INFO - Replacing 'model.layers.1.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:   6%|██▎                                   | 14/225 [10:43<3:23:27, 57.85s/it]2025-04-25 08:34:18,495 - INFO - Skipping layer model.layers.2.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:34:18,495 - INFO - Skipping layer model.layers.2.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:34:18,495 - INFO - Skipping layer model.layers.2.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:34:18,495 - INFO - Skipping layer model.layers.2.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:34:18,495 - INFO - Layer: model.layers.2.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:34:18,499 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_2_mlp_gate_proj.safetensors2025-04-25 08:34:18,500 - INFO - exists: True2025-04-25 08:34:18,557 - INFO - factorize_layer_kron_svd2025-04-25 08:34:20,420 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:34:21,865 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:34:23,322 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:34:24,764 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:34:26,206 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:34:27,948 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:34:30,255 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:34:32,836 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:34:35,377 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:34:38,021 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:34:41,815 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:34:46,819 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_2_mlp_gate_proj.safetensors TrueLayer: model.layers.2.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.0618421e-05 7.9699194e-06 7.3974884e-06 7.0551118e-06 6.9922344e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:36:06,464 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:36:06,465 - INFO - Replacing 'model.layers.2.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:   8%|███▏                                  | 19/225 [12:31<2:08:42, 37.49s/it]2025-04-25 08:36:06,465 - INFO - Layer: model.layers.2.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:36:06,470 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_2_mlp_up_proj.safetensors2025-04-25 08:36:06,470 - INFO - exists: True2025-04-25 08:36:06,527 - INFO - factorize_layer_kron_svd2025-04-25 08:36:08,427 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:36:09,864 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:36:11,305 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:36:12,743 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:36:14,194 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:36:15,984 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:36:18,311 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:36:21,112 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:36:23,726 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:36:26,183 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:36:29,307 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:36:34,133 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_2_mlp_up_proj.safetensors TrueLayer: model.layers.2.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.5428037e-06 4.2778834e-06 4.1640365e-06 4.1289068e-06 4.1148519e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:37:51,946 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:37:51,946 - INFO - Replacing 'model.layers.2.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:   9%|███▍                                  | 20/225 [14:16<2:40:12, 46.89s/it]2025-04-25 08:37:51,947 - INFO - Layer: model.layers.2.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:37:51,951 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_2_mlp_down_proj.safetensors2025-04-25 08:37:51,952 - INFO - exists: True2025-04-25 08:37:51,998 - INFO - factorize_layer_kron_svd2025-04-25 08:37:54,463 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:37:57,052 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:37:59,655 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:38:02,183 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:38:04,711 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:38:09,223 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:38:10,624 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:38:12,057 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:38:13,484 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:38:14,936 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:38:16,374 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:38:18,164 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_2_mlp_down_proj.safetensors TrueLayer: model.layers.2.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [5.6728236e-06 4.6945897e-06 4.5337383e-06 4.4726326e-06 4.2851893e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 08:39:39,275 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 08:39:39,276 - INFO - Replacing 'model.layers.2.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:   9%|███▌                                  | 21/225 [16:03<3:13:19, 56.86s/it]2025-04-25 08:39:39,276 - INFO - Skipping layer model.layers.3.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:39:39,276 - INFO - Skipping layer model.layers.3.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:39:39,276 - INFO - Skipping layer model.layers.3.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:39:39,276 - INFO - Skipping layer model.layers.3.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:39:39,277 - INFO - Layer: model.layers.3.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:39:39,281 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_3_mlp_gate_proj.safetensors2025-04-25 08:39:39,281 - INFO - exists: True2025-04-25 08:39:39,311 - INFO - factorize_layer_kron_svd2025-04-25 08:39:42,083 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:39:43,514 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:39:44,964 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:39:46,403 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:39:47,839 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:39:49,785 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:39:52,076 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:39:54,665 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:39:57,209 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:39:59,888 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:40:02,769 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:40:08,021 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_3_mlp_gate_proj.safetensors TrueLayer: model.layers.3.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [9.854040e-06 7.767722e-06 6.585744e-06 6.523616e-06 6.122345e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:41:22,160 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:41:22,160 - INFO - Replacing 'model.layers.3.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  12%|████▍                                 | 26/225 [17:46<2:03:29, 37.23s/it]2025-04-25 08:41:22,161 - INFO - Layer: model.layers.3.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:41:22,165 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_3_mlp_up_proj.safetensors2025-04-25 08:41:22,165 - INFO - exists: True2025-04-25 08:41:22,224 - INFO - factorize_layer_kron_svd2025-04-25 08:41:25,024 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:41:26,774 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 08:41:31,156 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_3_mlp_up_proj.safetensors TrueLayer: model.layers.3.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.1834992e-04 4.5552537e-05 2.4106155e-05 1.9258701e-05 1.8225728e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:42:50,140 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:42:50,141 - INFO - Replacing 'model.layers.3.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  12%|████▌                                 | 27/225 [19:14<2:25:17, 44.03s/it]2025-04-25 08:42:50,149 - INFO - Layer: model.layers.3.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:42:50,153 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_3_mlp_down_proj.safetensors2025-04-25 08:42:50,154 - INFO - exists: True2025-04-25 08:42:50,187 - INFO - factorize_layer_kron_svd2025-04-25 08:42:54,487 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:42:58,431 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:43:03,126 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:43:08,066 - INFO -   Factor is positive definite (alpha=1.00e-02)2025-04-25 08:43:09,634 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:43:11,331 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_3_mlp_down_proj.safetensors TrueLayer: model.layers.3.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-02)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [4.5485570e-04 3.7422869e-05 2.5017107e-05 1.0035806e-05 8.8333263e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 08:44:51,062 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 08:44:51,063 - INFO - Replacing 'model.layers.3.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  12%|████▋                                 | 28/225 [21:15<3:05:05, 56.37s/it]2025-04-25 08:44:51,063 - INFO - Skipping layer model.layers.4.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:44:51,063 - INFO - Skipping layer model.layers.4.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:44:51,063 - INFO - Skipping layer model.layers.4.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:44:51,063 - INFO - Skipping layer model.layers.4.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:44:51,063 - INFO - Layer: model.layers.4.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:44:51,068 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_4_mlp_gate_proj.safetensors2025-04-25 08:44:51,068 - INFO - exists: True2025-04-25 08:44:51,104 - INFO - factorize_layer_kron_svd2025-04-25 08:44:53,648 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:44:55,076 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:44:56,504 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:44:57,957 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:44:59,440 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:45:01,259 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:45:03,513 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:45:06,079 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:45:08,516 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:45:10,980 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:45:14,103 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:45:19,208 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_4_mlp_gate_proj.safetensors TrueLayer: model.layers.4.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.0920234e-05 7.0109541e-06 6.9248686e-06 6.6595962e-06 6.4585270e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:46:41,561 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:46:41,561 - INFO - Replacing 'model.layers.4.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  15%|█████▌                                | 33/225 [23:06<2:01:48, 38.06s/it]2025-04-25 08:46:41,561 - INFO - Layer: model.layers.4.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:46:41,565 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_4_mlp_up_proj.safetensors2025-04-25 08:46:41,565 - INFO - exists: True2025-04-25 08:46:41,601 - INFO - factorize_layer_kron_svd2025-04-25 08:46:44,027 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:46:45,480 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:46:46,924 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:46:48,366 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:46:49,792 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:46:51,508 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:46:53,719 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:46:56,213 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:46:58,731 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:47:01,240 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:47:03,914 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:47:08,832 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_4_mlp_up_proj.safetensors TrueLayer: model.layers.4.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.2933643e-06 3.9869037e-06 3.8469866e-06 3.7983618e-06 3.7545904e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:48:35,554 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:48:35,554 - INFO - Replacing 'model.layers.4.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  15%|█████▋                                | 34/225 [25:00<2:33:10, 48.12s/it]2025-04-25 08:48:35,555 - INFO - Layer: model.layers.4.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:48:35,559 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_4_mlp_down_proj.safetensors2025-04-25 08:48:35,559 - INFO - exists: True2025-04-25 08:48:35,594 - INFO - factorize_layer_kron_svd2025-04-25 08:48:40,237 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:48:44,286 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:48:49,212 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 08:48:50,731 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:48:52,423 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_4_mlp_down_proj.safetensors TrueLayer: model.layers.4.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [2.7966772e-03 3.1094739e-04 3.4516503e-05 2.9406374e-05 2.7459462e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 08:50:29,947 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 08:50:29,947 - INFO - Replacing 'model.layers.4.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  16%|█████▉                                | 35/225 [26:54<3:05:45, 58.66s/it]2025-04-25 08:50:29,948 - INFO - Skipping layer model.layers.5.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:50:29,948 - INFO - Skipping layer model.layers.5.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:50:29,948 - INFO - Skipping layer model.layers.5.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:50:29,948 - INFO - Skipping layer model.layers.5.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:50:29,948 - INFO - Layer: model.layers.5.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:50:29,952 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_5_mlp_gate_proj.safetensors2025-04-25 08:50:29,952 - INFO - exists: True2025-04-25 08:50:29,983 - INFO - factorize_layer_kron_svd2025-04-25 08:50:32,844 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:50:34,501 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:50:36,260 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 08:50:40,858 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_5_mlp_gate_proj.safetensors TrueLayer: model.layers.5.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [8.7296218e-04 5.4562439e-05 3.5548554e-05 2.7083914e-05 2.4795821e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:52:00,969 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:52:00,969 - INFO - Replacing 'model.layers.5.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  18%|██████▊                               | 40/225 [28:25<1:54:31, 37.14s/it]2025-04-25 08:52:00,969 - INFO - Layer: model.layers.5.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:52:00,973 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_5_mlp_up_proj.safetensors2025-04-25 08:52:00,973 - INFO - exists: True2025-04-25 08:52:01,003 - INFO - factorize_layer_kron_svd2025-04-25 08:52:03,615 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:52:05,070 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:52:06,584 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:52:08,024 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:52:09,462 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:52:11,130 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:52:13,349 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:52:15,886 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:52:18,394 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:52:20,951 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:52:23,565 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:52:28,359 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_5_mlp_up_proj.safetensors TrueLayer: model.layers.5.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.4547860e-06 4.1633093e-06 4.0426671e-06 3.9856382e-06 3.9299944e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:53:50,166 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:53:50,167 - INFO - Replacing 'model.layers.5.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  18%|██████▉                               | 41/225 [30:14<2:23:03, 46.65s/it]2025-04-25 08:53:50,167 - INFO - Layer: model.layers.5.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:53:50,172 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_5_mlp_down_proj.safetensors2025-04-25 08:53:50,172 - INFO - exists: True2025-04-25 08:53:50,200 - INFO - factorize_layer_kron_svd2025-04-25 08:53:53,571 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:53:56,068 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:53:58,553 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:54:01,026 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:54:03,446 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:54:08,112 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:54:09,520 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:54:10,939 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:54:12,368 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:54:13,793 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:54:15,226 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:54:16,924 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_5_mlp_down_proj.safetensors TrueLayer: model.layers.5.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [6.4384844e-06 5.3451959e-06 4.9290616e-06 4.7053259e-06 4.6674850e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 08:55:55,838 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 08:55:55,839 - INFO - Replacing 'model.layers.5.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  19%|███████                               | 42/225 [32:20<3:00:29, 59.18s/it]2025-04-25 08:55:55,839 - INFO - Skipping layer model.layers.6.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:55:55,839 - INFO - Skipping layer model.layers.6.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:55:55,839 - INFO - Skipping layer model.layers.6.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:55:55,839 - INFO - Skipping layer model.layers.6.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 08:55:55,839 - INFO - Layer: model.layers.6.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:55:55,843 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_6_mlp_gate_proj.safetensors2025-04-25 08:55:55,844 - INFO - exists: True2025-04-25 08:55:55,871 - INFO - factorize_layer_kron_svd2025-04-25 08:55:58,408 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:55:59,905 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:56:01,339 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:56:02,776 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:56:04,211 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:56:05,946 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:56:08,172 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:56:10,627 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:56:13,035 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:56:15,460 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:56:18,549 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:56:23,520 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_6_mlp_gate_proj.safetensors TrueLayer: model.layers.6.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.3932034e-05 7.6070046e-06 7.2612047e-06 7.2457228e-06 6.9333705e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:57:39,656 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:57:39,656 - INFO - Replacing 'model.layers.6.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  21%|███████▉                              | 47/225 [34:04<1:55:02, 38.78s/it]2025-04-25 08:57:39,656 - INFO - Layer: model.layers.6.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:57:39,661 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_6_mlp_up_proj.safetensors2025-04-25 08:57:39,661 - INFO - exists: True2025-04-25 08:57:39,689 - INFO - factorize_layer_kron_svd2025-04-25 08:57:42,434 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:57:44,124 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:57:45,835 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 08:57:50,155 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_6_mlp_up_proj.safetensors TrueLayer: model.layers.6.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.2993153e-04 3.3647168e-05 2.7428094e-05 2.3612538e-05 2.0478037e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 08:59:13,342 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 08:59:13,343 - INFO - Replacing 'model.layers.6.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  21%|████████                              | 48/225 [35:38<2:15:43, 46.01s/it]2025-04-25 08:59:13,343 - INFO - Layer: model.layers.6.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 08:59:13,356 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_6_mlp_down_proj.safetensors2025-04-25 08:59:13,356 - INFO - exists: True2025-04-25 08:59:13,387 - INFO - factorize_layer_kron_svd2025-04-25 08:59:16,781 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:59:19,488 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:59:21,919 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:59:24,341 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:59:26,748 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:59:31,719 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 08:59:33,142 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 08:59:34,589 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 08:59:36,024 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 08:59:37,488 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 08:59:38,925 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 08:59:40,645 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_6_mlp_down_proj.safetensors TrueLayer: model.layers.6.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [6.2935410e-06 6.1514793e-06 5.0011340e-06 4.8704014e-06 4.6754294e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:01:26,835 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:01:26,836 - INFO - Replacing 'model.layers.6.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  22%|████████▎                             | 49/225 [37:51<2:55:36, 59.87s/it]2025-04-25 09:01:26,836 - INFO - Skipping layer model.layers.7.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:01:26,836 - INFO - Skipping layer model.layers.7.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:01:26,836 - INFO - Skipping layer model.layers.7.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:01:26,836 - INFO - Skipping layer model.layers.7.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:01:26,836 - INFO - Layer: model.layers.7.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:01:26,841 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_7_mlp_gate_proj.safetensors2025-04-25 09:01:26,841 - INFO - exists: True2025-04-25 09:01:26,868 - INFO - factorize_layer_kron_svd2025-04-25 09:01:29,538 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:01:31,263 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:01:35,884 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_7_mlp_gate_proj.safetensors TrueLayer: model.layers.7.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [5.2013673e-04 3.0886171e-05 2.4866824e-05 2.3573557e-05 2.1321908e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:02:59,007 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:02:59,008 - INFO - Replacing 'model.layers.7.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  24%|█████████                             | 54/225 [39:23<1:47:56, 37.87s/it]2025-04-25 09:02:59,008 - INFO - Layer: model.layers.7.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:02:59,013 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_7_mlp_up_proj.safetensors2025-04-25 09:02:59,013 - INFO - exists: True2025-04-25 09:02:59,043 - INFO - factorize_layer_kron_svd2025-04-25 09:03:01,950 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:03:03,708 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:03:08,230 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_7_mlp_up_proj.safetensors TrueLayer: model.layers.7.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.1453493e-04 2.6784135e-05 2.6219981e-05 2.0122987e-05 1.7252345e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:04:31,156 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:04:31,156 - INFO - Replacing 'model.layers.7.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  24%|█████████▎                            | 55/225 [40:55<2:07:33, 45.02s/it]2025-04-25 09:04:31,156 - INFO - Layer: model.layers.7.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:04:31,161 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_7_mlp_down_proj.safetensors2025-04-25 09:04:31,161 - INFO - exists: True2025-04-25 09:04:31,191 - INFO - factorize_layer_kron_svd2025-04-25 09:04:34,524 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:04:37,075 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:04:39,548 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 09:04:41,976 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 09:04:44,396 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 09:04:49,062 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 09:04:50,499 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:04:51,933 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:04:53,368 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 09:04:54,793 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 09:04:56,240 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 09:04:57,950 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_7_mlp_down_proj.safetensors TrueLayer: model.layers.7.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [6.7382989e-06 5.3078243e-06 5.0812632e-06 4.8952493e-06 4.8214606e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:06:37,888 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:06:37,889 - INFO - Replacing 'model.layers.7.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  25%|█████████▍                            | 56/225 [43:02<2:43:15, 57.96s/it]2025-04-25 09:06:37,889 - INFO - Skipping layer model.layers.8.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:06:37,889 - INFO - Skipping layer model.layers.8.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:06:37,889 - INFO - Skipping layer model.layers.8.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:06:37,889 - INFO - Skipping layer model.layers.8.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:06:37,889 - INFO - Layer: model.layers.8.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:06:37,905 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_8_mlp_gate_proj.safetensors2025-04-25 09:06:37,905 - INFO - exists: True2025-04-25 09:06:37,936 - INFO - factorize_layer_kron_svd2025-04-25 09:06:40,800 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:06:42,441 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:06:44,118 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:06:48,636 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_8_mlp_gate_proj.safetensors TrueLayer: model.layers.8.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.0635996e-04 3.2061293e-05 2.8866420e-05 2.0697351e-05 2.0467176e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:08:07,247 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:08:07,247 - INFO - Replacing 'model.layers.8.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  27%|██████████▎                           | 61/225 [44:31<1:40:16, 36.68s/it]2025-04-25 09:08:07,248 - INFO - Layer: model.layers.8.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:08:07,252 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_8_mlp_up_proj.safetensors2025-04-25 09:08:07,252 - INFO - exists: True2025-04-25 09:08:07,279 - INFO - factorize_layer_kron_svd2025-04-25 09:08:10,134 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:08:11,747 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:08:13,410 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:08:17,619 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_8_mlp_up_proj.safetensors TrueLayer: model.layers.8.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.1513238e-04 3.2227195e-05 2.3494455e-05 2.1498236e-05 1.8489127e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:09:32,556 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:09:32,556 - INFO - Replacing 'model.layers.8.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  28%|██████████▍                           | 62/225 [45:57<1:57:03, 43.09s/it]2025-04-25 09:09:32,556 - INFO - Layer: model.layers.8.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:09:32,561 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_8_mlp_down_proj.safetensors2025-04-25 09:09:32,561 - INFO - exists: True2025-04-25 09:09:32,590 - INFO - factorize_layer_kron_svd2025-04-25 09:09:38,018 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 09:09:39,551 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_8_mlp_down_proj.safetensors TrueLayer: model.layers.8.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.51505542e-03 2.34301886e-04 1.14707866e-04 1.01979953e-04 9.41418693e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:11:11,949 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:11:11,949 - INFO - Replacing 'model.layers.8.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  28%|██████████▋                           | 63/225 [47:36<2:20:24, 52.00s/it]2025-04-25 09:11:11,950 - INFO - Skipping layer model.layers.9.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:11:11,950 - INFO - Skipping layer model.layers.9.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:11:11,950 - INFO - Skipping layer model.layers.9.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:11:11,950 - INFO - Skipping layer model.layers.9.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:11:11,950 - INFO - Layer: model.layers.9.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:11:11,968 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_9_mlp_gate_proj.safetensors2025-04-25 09:11:11,968 - INFO - exists: True2025-04-25 09:11:11,997 - INFO - factorize_layer_kron_svd2025-04-25 09:11:15,339 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:11:17,040 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:11:21,882 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_9_mlp_gate_proj.safetensors TrueLayer: model.layers.9.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.5003841e-04 3.3992299e-05 2.4137324e-05 2.0222767e-05 1.6737577e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:12:45,956 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:12:45,957 - INFO - Replacing 'model.layers.9.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  30%|███████████▍                          | 68/225 [49:10<1:29:57, 34.38s/it]2025-04-25 09:12:45,957 - INFO - Layer: model.layers.9.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:12:45,992 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_9_mlp_up_proj.safetensors2025-04-25 09:12:45,993 - INFO - exists: True2025-04-25 09:12:46,060 - INFO - factorize_layer_kron_svd2025-04-25 09:12:48,934 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:12:50,629 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:12:55,014 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_9_mlp_up_proj.safetensors TrueLayer: model.layers.9.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.4804383e-04 7.1430317e-05 3.7694856e-05 3.0666481e-05 2.7209046e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:14:17,048 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:14:17,048 - INFO - Replacing 'model.layers.9.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  31%|███████████▋                          | 69/225 [50:41<1:48:48, 41.85s/it]2025-04-25 09:14:17,049 - INFO - Layer: model.layers.9.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:14:17,081 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_9_mlp_down_proj.safetensors2025-04-25 09:14:17,081 - INFO - exists: True2025-04-25 09:14:17,105 - INFO - factorize_layer_kron_svd2025-04-25 09:14:22,668 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:14:27,640 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:14:29,453 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_9_mlp_down_proj.safetensors TrueLayer: model.layers.9.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.1804680e-03 3.4042375e-04 1.2402669e-04 1.1540504e-04 9.3239483e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:16:08,538 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:16:08,539 - INFO - Replacing 'model.layers.9.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  31%|███████████▊                          | 70/225 [52:33<2:16:35, 52.87s/it]2025-04-25 09:16:08,539 - INFO - Skipping layer model.layers.10.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:16:08,539 - INFO - Skipping layer model.layers.10.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:16:08,539 - INFO - Skipping layer model.layers.10.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:16:08,539 - INFO - Skipping layer model.layers.10.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:16:08,539 - INFO - Layer: model.layers.10.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:16:08,544 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_10_mlp_gate_proj.safetensors2025-04-25 09:16:08,544 - INFO - exists: True2025-04-25 09:16:08,576 - INFO - factorize_layer_kron_svd2025-04-25 09:16:10,418 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:16:12,043 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:16:13,717 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:16:17,660 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:16:22,644 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_10_mlp_gate_proj.safetensors TrueLayer: model.layers.10.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [5.6674529e-04 1.9079163e-04 2.7858981e-05 2.6801015e-05 2.1280433e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:17:43,645 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:17:43,646 - INFO - Replacing 'model.layers.10.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  33%|████████████▋                         | 75/225 [54:08<1:27:16, 34.91s/it]2025-04-25 09:17:43,646 - INFO - Layer: model.layers.10.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:17:43,651 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_10_mlp_up_proj.safetensors2025-04-25 09:17:43,651 - INFO - exists: True2025-04-25 09:17:43,696 - INFO - factorize_layer_kron_svd2025-04-25 09:17:45,544 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:17:47,355 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:17:51,589 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:17:56,539 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_10_mlp_up_proj.safetensors TrueLayer: model.layers.10.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.3547464e-04 6.7394722e-05 3.0478974e-05 2.3915027e-05 2.0884363e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:19:21,555 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:19:21,555 - INFO - Replacing 'model.layers.10.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  34%|████████████▊                         | 76/225 [55:46<1:47:17, 43.20s/it]2025-04-25 09:19:21,556 - INFO - Layer: model.layers.10.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:19:21,563 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_10_mlp_down_proj.safetensors2025-04-25 09:19:21,563 - INFO - exists: True2025-04-25 09:19:21,605 - INFO - factorize_layer_kron_svd2025-04-25 09:19:26,341 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 09:19:28,076 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_10_mlp_down_proj.safetensors TrueLayer: model.layers.10.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [9.5235155e-04 4.4385294e-04 1.3134204e-04 1.0461983e-04 8.7733199e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:21:12,644 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:21:12,644 - INFO - Replacing 'model.layers.10.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  34%|█████████████                         | 77/225 [57:37<2:13:04, 53.95s/it]2025-04-25 09:21:12,645 - INFO - Skipping layer model.layers.11.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:21:12,645 - INFO - Skipping layer model.layers.11.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:21:12,645 - INFO - Skipping layer model.layers.11.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:21:12,645 - INFO - Skipping layer model.layers.11.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:21:12,645 - INFO - Layer: model.layers.11.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:21:12,649 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_11_mlp_gate_proj.safetensors2025-04-25 09:21:12,649 - INFO - exists: True2025-04-25 09:21:12,690 - INFO - factorize_layer_kron_svd2025-04-25 09:21:14,535 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:21:16,249 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:21:21,148 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_11_mlp_gate_proj.safetensors TrueLayer: model.layers.11.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [6.3607935e-04 2.9990711e-05 2.1020067e-05 1.4805258e-05 1.4210298e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:22:46,844 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:22:46,844 - INFO - Replacing 'model.layers.11.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  36%|█████████████▊                        | 82/225 [59:11<1:24:10, 35.32s/it]2025-04-25 09:22:46,844 - INFO - Layer: model.layers.11.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:22:46,848 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_11_mlp_up_proj.safetensors2025-04-25 09:22:46,849 - INFO - exists: True2025-04-25 09:22:46,887 - INFO - factorize_layer_kron_svd2025-04-25 09:22:48,652 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:22:50,414 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:22:52,148 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:22:56,731 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_11_mlp_up_proj.safetensors TrueLayer: model.layers.11.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.5943714e-04 2.7045689e-05 2.6607122e-05 1.6486258e-05 1.5736074e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:24:20,740 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:24:20,741 - INFO - Replacing 'model.layers.11.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  37%|█████████████▎                      | 83/225 [1:00:45<1:41:50, 43.03s/it]2025-04-25 09:24:20,741 - INFO - Layer: model.layers.11.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:24:20,746 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_11_mlp_down_proj.safetensors2025-04-25 09:24:20,746 - INFO - exists: True2025-04-25 09:24:20,785 - INFO - factorize_layer_kron_svd2025-04-25 09:24:25,404 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:24:30,549 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:24:32,267 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_11_mlp_down_proj.safetensors TrueLayer: model.layers.11.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [8.2638772e-04 3.2490629e-04 9.3364506e-05 7.9967816e-05 7.6163844e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:26:14,034 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:26:14,035 - INFO - Replacing 'model.layers.11.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  37%|█████████████▍                      | 84/225 [1:02:38<2:07:15, 54.15s/it]2025-04-25 09:26:14,035 - INFO - Skipping layer model.layers.12.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:26:14,035 - INFO - Skipping layer model.layers.12.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:26:14,035 - INFO - Skipping layer model.layers.12.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:26:14,035 - INFO - Skipping layer model.layers.12.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:26:14,035 - INFO - Layer: model.layers.12.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:26:14,039 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_12_mlp_gate_proj.safetensors2025-04-25 09:26:14,040 - INFO - exists: True2025-04-25 09:26:14,097 - INFO - factorize_layer_kron_svd2025-04-25 09:26:15,859 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:26:17,656 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:26:22,441 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_12_mlp_gate_proj.safetensors TrueLayer: model.layers.12.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.4531584e-04 4.3154534e-05 2.8466005e-05 2.0477491e-05 1.5518715e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:27:49,739 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:27:49,740 - INFO - Replacing 'model.layers.12.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  40%|██████████████▏                     | 89/225 [1:04:14<1:20:37, 35.57s/it]2025-04-25 09:27:49,740 - INFO - Layer: model.layers.12.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:27:49,744 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_12_mlp_up_proj.safetensors2025-04-25 09:27:49,744 - INFO - exists: True2025-04-25 09:27:49,781 - INFO - factorize_layer_kron_svd2025-04-25 09:27:51,743 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:27:53,740 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:27:58,465 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_12_mlp_up_proj.safetensors TrueLayer: model.layers.12.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.1828784e-04 4.3379245e-05 2.2649980e-05 1.7851604e-05 1.5423564e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:29:27,471 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:29:27,472 - INFO - Replacing 'model.layers.12.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  40%|██████████████▍                     | 90/225 [1:05:52<1:38:27, 43.76s/it]2025-04-25 09:29:27,472 - INFO - Layer: model.layers.12.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:29:27,476 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_12_mlp_down_proj.safetensors2025-04-25 09:29:27,476 - INFO - exists: True2025-04-25 09:29:27,519 - INFO - factorize_layer_kron_svd2025-04-25 09:29:32,007 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:29:37,057 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:29:38,763 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_12_mlp_down_proj.safetensors TrueLayer: model.layers.12.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.16941473e-03 2.03773263e-04 1.23114049e-04 1.06934065e-04 8.50328361e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:31:27,933 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:31:27,934 - INFO - Replacing 'model.layers.12.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  40%|██████████████▌                     | 91/225 [1:07:52<2:04:50, 55.90s/it]2025-04-25 09:31:27,934 - INFO - Skipping layer model.layers.13.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:31:27,934 - INFO - Skipping layer model.layers.13.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:31:27,934 - INFO - Skipping layer model.layers.13.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:31:27,934 - INFO - Skipping layer model.layers.13.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:31:27,934 - INFO - Layer: model.layers.13.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:31:27,939 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_13_mlp_gate_proj.safetensors2025-04-25 09:31:27,939 - INFO - exists: True2025-04-25 09:31:27,977 - INFO - factorize_layer_kron_svd2025-04-25 09:31:29,922 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:31:31,639 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:31:33,404 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:31:38,200 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_13_mlp_gate_proj.safetensors TrueLayer: model.layers.13.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [6.7581644e-04 5.4713801e-05 3.6352016e-05 2.1053142e-05 1.6110607e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:33:07,269 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:33:07,269 - INFO - Replacing 'model.layers.13.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  43%|███████████████▎                    | 96/225 [1:09:31<1:19:04, 36.78s/it]2025-04-25 09:33:07,269 - INFO - Layer: model.layers.13.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:33:07,274 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_13_mlp_up_proj.safetensors2025-04-25 09:33:07,274 - INFO - exists: True2025-04-25 09:33:07,316 - INFO - factorize_layer_kron_svd2025-04-25 09:33:09,294 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:33:11,044 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:33:15,647 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_13_mlp_up_proj.safetensors TrueLayer: model.layers.13.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.8558495e-04 5.8207741e-05 2.5255949e-05 1.6674767e-05 1.5271171e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:34:43,643 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:34:43,643 - INFO - Replacing 'model.layers.13.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  43%|███████████████▌                    | 97/225 [1:11:08<1:35:11, 44.62s/it]2025-04-25 09:34:43,644 - INFO - Layer: model.layers.13.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:34:43,648 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_13_mlp_down_proj.safetensors2025-04-25 09:34:43,648 - INFO - exists: True2025-04-25 09:34:43,685 - INFO - factorize_layer_kron_svd2025-04-25 09:34:47,976 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:34:52,945 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:34:54,638 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_13_mlp_down_proj.safetensors TrueLayer: model.layers.13.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [8.1429450e-04 2.6292430e-04 1.3004697e-04 7.7190954e-05 7.2983166e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:36:42,055 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:36:42,056 - INFO - Replacing 'model.layers.13.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  44%|███████████████▋                    | 98/225 [1:13:06<1:59:10, 56.31s/it]2025-04-25 09:36:42,056 - INFO - Skipping layer model.layers.14.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:36:42,056 - INFO - Skipping layer model.layers.14.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:36:42,056 - INFO - Skipping layer model.layers.14.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:36:42,056 - INFO - Skipping layer model.layers.14.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:36:42,057 - INFO - Layer: model.layers.14.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:36:42,069 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_14_mlp_gate_proj.safetensors2025-04-25 09:36:42,069 - INFO - exists: True2025-04-25 09:36:42,113 - INFO - factorize_layer_kron_svd2025-04-25 09:36:44,129 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:36:45,919 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:36:50,725 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_14_mlp_gate_proj.safetensors TrueLayer: model.layers.14.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.56832844e-04 3.98989141e-05 2.01317325e-05 1.53056189e-05 1.36924455e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:38:18,211 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:38:18,212 - INFO - Replacing 'model.layers.14.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  46%|████████████████                   | 103/225 [1:14:42<1:14:28, 36.63s/it]2025-04-25 09:38:18,212 - INFO - Layer: model.layers.14.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:38:18,220 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_14_mlp_up_proj.safetensors2025-04-25 09:38:18,220 - INFO - exists: True2025-04-25 09:38:18,261 - INFO - factorize_layer_kron_svd2025-04-25 09:38:20,296 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:38:22,042 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:38:26,816 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_14_mlp_up_proj.safetensors TrueLayer: model.layers.14.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.49276030e-04 1.00142104e-04 2.47551343e-05 1.75051719e-05 1.20034174e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:39:53,359 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:39:53,360 - INFO - Replacing 'model.layers.14.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  46%|████████████████▏                  | 104/225 [1:16:18<1:29:24, 44.34s/it]2025-04-25 09:39:53,360 - INFO - Layer: model.layers.14.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:39:53,364 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_14_mlp_down_proj.safetensors2025-04-25 09:39:53,364 - INFO - exists: True2025-04-25 09:39:53,402 - INFO - factorize_layer_kron_svd2025-04-25 09:39:57,920 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:40:03,352 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:40:05,068 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_14_mlp_down_proj.safetensors TrueLayer: model.layers.14.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.0443383e-03 1.6717993e-04 1.2500216e-04 9.2395770e-05 8.0791375e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:41:52,858 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:41:52,859 - INFO - Replacing 'model.layers.14.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  47%|████████████████▎                  | 105/225 [1:18:17<1:52:28, 56.23s/it]2025-04-25 09:41:52,859 - INFO - Skipping layer model.layers.15.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:41:52,859 - INFO - Skipping layer model.layers.15.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:41:52,859 - INFO - Skipping layer model.layers.15.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:41:52,859 - INFO - Skipping layer model.layers.15.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:41:52,859 - INFO - Layer: model.layers.15.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:41:52,862 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_15_mlp_gate_proj.safetensors2025-04-25 09:41:52,862 - INFO - exists: True2025-04-25 09:41:52,897 - INFO - factorize_layer_kron_svd2025-04-25 09:41:54,728 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:41:56,404 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:41:58,157 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:42:02,522 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:42:07,638 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_15_mlp_gate_proj.safetensors TrueLayer: model.layers.15.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.9388543e-04 1.5287376e-04 1.9112440e-05 1.6765847e-05 1.5848784e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:43:32,340 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:43:32,341 - INFO - Replacing 'model.layers.15.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  49%|█████████████████                  | 110/225 [1:19:57<1:10:49, 36.95s/it]2025-04-25 09:43:32,341 - INFO - Layer: model.layers.15.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:43:32,344 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_15_mlp_up_proj.safetensors2025-04-25 09:43:32,344 - INFO - exists: True2025-04-25 09:43:32,381 - INFO - factorize_layer_kron_svd2025-04-25 09:43:34,229 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:43:35,852 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:43:37,698 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:43:41,286 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:43:46,352 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_15_mlp_up_proj.safetensors TrueLayer: model.layers.15.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.7003489e-04 4.6190191e-05 1.9766498e-05 1.1650223e-05 1.1308205e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:45:10,477 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:45:10,477 - INFO - Replacing 'model.layers.15.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  49%|█████████████████▎                 | 111/225 [1:21:35<1:25:30, 45.01s/it]2025-04-25 09:45:10,478 - INFO - Layer: model.layers.15.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:45:10,480 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_15_mlp_down_proj.safetensors2025-04-25 09:45:10,480 - INFO - exists: True2025-04-25 09:45:10,549 - INFO - factorize_layer_kron_svd2025-04-25 09:45:15,930 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 09:45:17,742 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_15_mlp_down_proj.safetensors TrueLayer: model.layers.15.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [7.3314056e-04 2.5684579e-04 1.0939063e-04 1.0301727e-04 8.0257261e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:47:04,148 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:47:04,149 - INFO - Replacing 'model.layers.15.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  50%|█████████████████▍                 | 112/225 [1:23:28<1:45:14, 55.88s/it]2025-04-25 09:47:04,149 - INFO - Skipping layer model.layers.16.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:47:04,149 - INFO - Skipping layer model.layers.16.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:47:04,149 - INFO - Skipping layer model.layers.16.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:47:04,149 - INFO - Skipping layer model.layers.16.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:47:04,150 - INFO - Layer: model.layers.16.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:47:04,163 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_16_mlp_gate_proj.safetensors2025-04-25 09:47:04,163 - INFO - exists: True2025-04-25 09:47:04,217 - INFO - factorize_layer_kron_svd2025-04-25 09:47:06,035 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:47:07,507 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:47:08,962 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 09:47:10,422 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 09:47:11,867 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 09:47:13,750 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 09:47:15,956 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:47:18,548 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:47:21,097 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 09:47:23,716 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 09:47:28,209 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 09:47:33,267 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_16_mlp_gate_proj.safetensors TrueLayer: model.layers.16.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.3483214e-05 6.9513599e-06 6.7282763e-06 6.6373750e-06 6.4924552e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:49:00,858 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:49:00,858 - INFO - Replacing 'model.layers.16.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  52%|██████████████████▏                | 117/225 [1:25:25<1:09:29, 38.61s/it]2025-04-25 09:49:00,859 - INFO - Layer: model.layers.16.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:49:00,863 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_16_mlp_up_proj.safetensors2025-04-25 09:49:00,863 - INFO - exists: True2025-04-25 09:49:00,900 - INFO - factorize_layer_kron_svd2025-04-25 09:49:02,742 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:49:04,419 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:49:06,183 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:49:10,016 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:49:14,917 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_16_mlp_up_proj.safetensors TrueLayer: model.layers.16.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [8.3208195e-04 3.1273955e-06 1.1444918e-06 9.1868083e-07 8.7896450e-07]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:50:42,163 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:50:42,164 - INFO - Replacing 'model.layers.16.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  52%|██████████████████▎                | 118/225 [1:27:06<1:23:34, 46.87s/it]2025-04-25 09:50:42,164 - INFO - Layer: model.layers.16.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:50:42,168 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_16_mlp_down_proj.safetensors2025-04-25 09:50:42,168 - INFO - exists: True2025-04-25 09:50:42,205 - INFO - factorize_layer_kron_svd2025-04-25 09:50:45,632 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:50:50,681 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:50:52,178 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:50:53,945 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_16_mlp_down_proj.safetensors TrueLayer: model.layers.16.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [4.7270553e-03 1.7398477e-05 1.4059800e-05 8.7644266e-06 8.2238084e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:52:43,362 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:52:43,362 - INFO - Replacing 'model.layers.16.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  53%|██████████████████▌                | 119/225 [1:29:08<1:43:35, 58.63s/it]2025-04-25 09:52:43,363 - INFO - Skipping layer model.layers.17.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:52:43,363 - INFO - Skipping layer model.layers.17.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:52:43,363 - INFO - Skipping layer model.layers.17.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:52:43,363 - INFO - Skipping layer model.layers.17.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:52:43,363 - INFO - Layer: model.layers.17.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:52:43,366 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_17_mlp_gate_proj.safetensors2025-04-25 09:52:43,366 - INFO - exists: True2025-04-25 09:52:43,415 - INFO - factorize_layer_kron_svd2025-04-25 09:52:45,534 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:52:47,318 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 09:52:51,933 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_17_mlp_gate_proj.safetensors TrueLayer: model.layers.17.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [2.54266924e-04 6.19246202e-05 1.65375022e-05 1.18227745e-05 9.72756516e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:54:16,067 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:54:16,068 - INFO - Replacing 'model.layers.17.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  55%|███████████████████▎               | 124/225 [1:30:40<1:02:53, 37.36s/it]2025-04-25 09:54:16,068 - INFO - Layer: model.layers.17.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:54:16,072 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_17_mlp_up_proj.safetensors2025-04-25 09:54:16,072 - INFO - exists: True2025-04-25 09:54:16,111 - INFO - factorize_layer_kron_svd2025-04-25 09:54:18,180 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 09:54:22,951 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_17_mlp_up_proj.safetensors TrueLayer: model.layers.17.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [2.7037744e-04 6.1383049e-05 2.1801894e-05 1.8188519e-05 1.5120702e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:55:49,676 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:55:49,676 - INFO - Replacing 'model.layers.17.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  56%|███████████████████▍               | 125/225 [1:32:14<1:14:36, 44.76s/it]2025-04-25 09:55:49,677 - INFO - Layer: model.layers.17.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:55:49,681 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_17_mlp_down_proj.safetensors2025-04-25 09:55:49,681 - INFO - exists: True2025-04-25 09:55:49,720 - INFO - factorize_layer_kron_svd2025-04-25 09:55:54,855 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 09:55:56,558 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_17_mlp_down_proj.safetensors TrueLayer: model.layers.17.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.0443435e-03 1.7095005e-04 1.0738512e-04 1.0080472e-04 8.4120526e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 09:57:45,047 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 09:57:45,048 - INFO - Replacing 'model.layers.17.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  56%|███████████████████▌               | 126/225 [1:34:09<1:32:18, 55.94s/it]2025-04-25 09:57:45,048 - INFO - Skipping layer model.layers.18.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:57:45,048 - INFO - Skipping layer model.layers.18.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:57:45,048 - INFO - Skipping layer model.layers.18.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:57:45,049 - INFO - Skipping layer model.layers.18.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 09:57:45,049 - INFO - Layer: model.layers.18.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:57:45,053 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_18_mlp_gate_proj.safetensors2025-04-25 09:57:45,053 - INFO - exists: True2025-04-25 09:57:45,089 - INFO - factorize_layer_kron_svd2025-04-25 09:57:47,195 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:57:49,054 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:57:50,840 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 09:57:55,026 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:58:00,216 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_18_mlp_gate_proj.safetensors TrueLayer: model.layers.18.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [9.5983502e-05 6.8698682e-05 8.5536703e-06 5.9206495e-06 4.2786505e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 09:59:29,560 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 09:59:29,560 - INFO - Replacing 'model.layers.18.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  58%|█████████████████████▌               | 131/225 [1:35:54<58:30, 37.35s/it]2025-04-25 09:59:29,561 - INFO - Layer: model.layers.18.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 09:59:29,565 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_18_mlp_up_proj.safetensors2025-04-25 09:59:29,565 - INFO - exists: True2025-04-25 09:59:29,622 - INFO - factorize_layer_kron_svd2025-04-25 09:59:31,491 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:59:32,984 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:59:34,475 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 09:59:35,957 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 09:59:37,477 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 09:59:39,251 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 09:59:41,465 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 09:59:43,991 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 09:59:46,483 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 09:59:49,034 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 09:59:51,915 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 09:59:56,949 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_18_mlp_up_proj.safetensors TrueLayer: model.layers.18.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [6.0635898e-06 5.1785546e-06 4.6252180e-06 4.4940693e-06 4.4569811e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:01:23,648 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:01:23,649 - INFO - Replacing 'model.layers.18.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  59%|████████████████████▌              | 132/225 [1:37:48<1:13:32, 47.45s/it]2025-04-25 10:01:23,649 - INFO - Layer: model.layers.18.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:01:23,653 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_18_mlp_down_proj.safetensors2025-04-25 10:01:23,653 - INFO - exists: True2025-04-25 10:01:23,704 - INFO - factorize_layer_kron_svd2025-04-25 10:01:28,959 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 10:01:30,659 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_18_mlp_down_proj.safetensors TrueLayer: model.layers.18.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.16852054e-03 1.49163578e-04 1.20138946e-04 9.55816286e-05 7.54735811e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:03:14,638 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:03:14,638 - INFO - Replacing 'model.layers.18.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  59%|████████████████████▋              | 133/225 [1:39:39<1:28:10, 57.51s/it]2025-04-25 10:03:14,639 - INFO - Skipping layer model.layers.19.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:03:14,639 - INFO - Skipping layer model.layers.19.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:03:14,639 - INFO - Skipping layer model.layers.19.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:03:14,639 - INFO - Skipping layer model.layers.19.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:03:14,639 - INFO - Layer: model.layers.19.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:03:14,642 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_19_mlp_gate_proj.safetensors2025-04-25 10:03:14,642 - INFO - exists: True2025-04-25 10:03:14,703 - INFO - factorize_layer_kron_svd2025-04-25 10:03:16,640 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:03:18,409 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:03:20,261 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:03:23,866 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:03:28,944 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_19_mlp_gate_proj.safetensors TrueLayer: model.layers.19.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [6.2267238e-04 3.7720336e-06 9.2869959e-07 9.0698313e-07 8.0446836e-07]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:04:56,260 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:04:56,260 - INFO - Replacing 'model.layers.19.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  61%|██████████████████████▋              | 138/225 [1:41:20<54:46, 37.78s/it]2025-04-25 10:04:56,261 - INFO - Layer: model.layers.19.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:04:56,265 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_19_mlp_up_proj.safetensors2025-04-25 10:04:56,265 - INFO - exists: True2025-04-25 10:04:56,313 - INFO - factorize_layer_kron_svd2025-04-25 10:04:58,423 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:05:00,449 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 10:05:04,615 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:05:09,726 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_19_mlp_up_proj.safetensors TrueLayer: model.layers.19.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [5.8125769e-04 4.5030552e-06 2.6277819e-06 1.6868873e-06 1.3812053e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:06:38,359 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:06:38,360 - INFO - Replacing 'model.layers.19.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  62%|█████████████████████▌             | 139/225 [1:43:03<1:06:17, 46.24s/it]2025-04-25 10:06:38,360 - INFO - Layer: model.layers.19.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:06:38,364 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_19_mlp_down_proj.safetensors2025-04-25 10:06:38,365 - INFO - exists: True2025-04-25 10:06:38,418 - INFO - factorize_layer_kron_svd2025-04-25 10:06:42,095 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:06:47,142 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 10:06:48,636 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:06:50,350 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_19_mlp_down_proj.safetensors TrueLayer: model.layers.19.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [3.31551372e-03 1.58740149e-05 1.27824815e-05 8.81605501e-06 8.11397058e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:08:39,254 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:08:39,254 - INFO - Replacing 'model.layers.19.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  62%|█████████████████████▊             | 140/225 [1:45:03<1:22:15, 58.06s/it]2025-04-25 10:08:39,254 - INFO - Skipping layer model.layers.20.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:08:39,255 - INFO - Skipping layer model.layers.20.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:08:39,255 - INFO - Skipping layer model.layers.20.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:08:39,255 - INFO - Skipping layer model.layers.20.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:08:39,255 - INFO - Layer: model.layers.20.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:08:39,258 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_20_mlp_gate_proj.safetensors2025-04-25 10:08:39,258 - INFO - exists: True2025-04-25 10:08:39,312 - INFO - factorize_layer_kron_svd2025-04-25 10:08:41,421 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:08:43,276 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 10:08:47,098 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:08:52,093 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_20_mlp_gate_proj.safetensors TrueLayer: model.layers.20.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [7.0756985e-05 2.8748324e-05 1.6888569e-05 9.5970354e-06 4.3769605e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:10:18,596 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:10:18,597 - INFO - Replacing 'model.layers.20.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  64%|███████████████████████▊             | 145/225 [1:46:43<50:23, 37.79s/it]2025-04-25 10:10:18,598 - INFO - Layer: model.layers.20.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:10:18,606 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_20_mlp_up_proj.safetensors2025-04-25 10:10:18,607 - INFO - exists: True2025-04-25 10:10:18,648 - INFO - factorize_layer_kron_svd2025-04-25 10:10:20,757 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 10:10:25,613 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_20_mlp_up_proj.safetensors TrueLayer: model.layers.20.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [2.42336740e-04 2.43630839e-05 1.89080165e-05 1.40588845e-05 1.26285204e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:11:53,856 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:11:53,856 - INFO - Replacing 'model.layers.20.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  65%|████████████████████████             | 146/225 [1:48:18<59:43, 45.36s/it]2025-04-25 10:11:53,856 - INFO - Layer: model.layers.20.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:11:53,908 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_20_mlp_down_proj.safetensors2025-04-25 10:11:53,908 - INFO - exists: True2025-04-25 10:11:53,959 - INFO - factorize_layer_kron_svd2025-04-25 10:11:59,008 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 10:12:00,749 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_20_mlp_down_proj.safetensors TrueLayer: model.layers.20.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.56167394e-03 1.27065505e-04 1.07472355e-04 9.22967956e-05 7.22859768e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:13:45,457 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:13:45,458 - INFO - Replacing 'model.layers.20.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  65%|██████████████████████▊            | 147/225 [1:50:10<1:12:36, 55.85s/it]2025-04-25 10:13:45,459 - INFO - Skipping layer model.layers.21.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:13:45,459 - INFO - Skipping layer model.layers.21.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:13:45,459 - INFO - Skipping layer model.layers.21.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:13:45,459 - INFO - Skipping layer model.layers.21.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:13:45,459 - INFO - Layer: model.layers.21.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:13:45,464 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_21_mlp_gate_proj.safetensors2025-04-25 10:13:45,464 - INFO - exists: True2025-04-25 10:13:45,511 - INFO - factorize_layer_kron_svd2025-04-25 10:13:47,528 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:13:49,405 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:13:51,133 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:13:54,263 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:13:59,299 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_21_mlp_gate_proj.safetensors TrueLayer: model.layers.21.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [7.0320326e-05 1.6797596e-05 4.5691349e-06 2.2177326e-06 1.4598476e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:15:14,754 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:15:14,755 - INFO - Replacing 'model.layers.21.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  68%|████████████████████████▉            | 152/225 [1:51:39<43:25, 35.69s/it]2025-04-25 10:15:14,755 - INFO - Layer: model.layers.21.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:15:14,759 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_21_mlp_up_proj.safetensors2025-04-25 10:15:14,760 - INFO - exists: True2025-04-25 10:15:14,805 - INFO - factorize_layer_kron_svd2025-04-25 10:15:16,733 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:15:18,573 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:15:20,428 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:15:24,019 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:15:28,760 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_21_mlp_up_proj.safetensors TrueLayer: model.layers.21.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [5.6884775e-05 2.0481473e-05 3.5450871e-06 2.2727515e-06 1.6523041e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:16:45,540 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:16:45,541 - INFO - Replacing 'model.layers.21.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  68%|█████████████████████████▏           | 153/225 [1:53:10<51:31, 42.94s/it]2025-04-25 10:16:45,541 - INFO - Layer: model.layers.21.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:16:45,545 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_21_mlp_down_proj.safetensors2025-04-25 10:16:45,545 - INFO - exists: True2025-04-25 10:16:45,589 - INFO - factorize_layer_kron_svd2025-04-25 10:16:50,409 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 10:16:52,127 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_21_mlp_down_proj.safetensors TrueLayer: model.layers.21.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.3026327e-03 1.7837276e-04 1.1538375e-04 7.2806426e-05 6.8153298e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:18:32,849 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:18:32,849 - INFO - Replacing 'model.layers.21.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  68%|███████████████████████▉           | 154/225 [1:54:57<1:02:52, 53.13s/it]2025-04-25 10:18:32,850 - INFO - Skipping layer model.layers.22.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:18:32,850 - INFO - Skipping layer model.layers.22.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:18:32,850 - INFO - Skipping layer model.layers.22.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:18:32,850 - INFO - Skipping layer model.layers.22.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:18:32,850 - INFO - Layer: model.layers.22.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:18:32,854 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_22_mlp_gate_proj.safetensors2025-04-25 10:18:32,854 - INFO - exists: True2025-04-25 10:18:32,919 - INFO - factorize_layer_kron_svd2025-04-25 10:18:34,812 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:18:36,300 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:18:37,831 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:18:39,284 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:18:40,742 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:18:42,454 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 10:18:44,638 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:18:47,168 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:18:49,593 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:18:52,038 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:18:54,687 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:18:59,865 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_22_mlp_gate_proj.safetensors TrueLayer: model.layers.22.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.19196975e-05 6.61911417e-06 6.20118226e-06 6.13999691e-06 5.88456578e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:20:29,463 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:20:29,463 - INFO - Replacing 'model.layers.22.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  71%|██████████████████████████▏          | 159/225 [1:56:54<41:02, 37.31s/it]2025-04-25 10:20:29,464 - INFO - Layer: model.layers.22.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:20:29,468 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_22_mlp_up_proj.safetensors2025-04-25 10:20:29,468 - INFO - exists: True2025-04-25 10:20:29,556 - INFO - factorize_layer_kron_svd2025-04-25 10:20:31,427 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:20:33,119 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:20:34,888 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:20:39,042 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:20:44,043 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_22_mlp_up_proj.safetensors TrueLayer: model.layers.22.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [2.2060737e-04 1.5076038e-05 8.2074203e-06 8.0159416e-06 7.5865723e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:22:09,359 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:22:09,359 - INFO - Replacing 'model.layers.22.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  71%|██████████████████████████▎          | 160/225 [1:58:34<49:20, 45.55s/it]2025-04-25 10:22:09,360 - INFO - Layer: model.layers.22.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:22:09,364 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_22_mlp_down_proj.safetensors2025-04-25 10:22:09,364 - INFO - exists: True2025-04-25 10:22:09,405 - INFO - factorize_layer_kron_svd2025-04-25 10:22:11,991 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:22:14,515 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:22:16,993 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:22:19,676 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:22:22,143 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:22:26,940 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 10:22:28,393 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:22:29,850 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:22:31,305 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:22:32,769 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:22:34,297 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:22:36,079 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_22_mlp_down_proj.safetensors TrueLayer: model.layers.22.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [5.2760347e-06 5.0417261e-06 4.6435966e-06 4.2178845e-06 4.0665909e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:24:22,153 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:24:22,154 - INFO - Replacing 'model.layers.22.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  72%|█████████████████████████          | 161/225 [2:00:46<1:03:19, 59.36s/it]2025-04-25 10:24:22,154 - INFO - Skipping layer model.layers.23.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:24:22,154 - INFO - Skipping layer model.layers.23.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:24:22,154 - INFO - Skipping layer model.layers.23.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:24:22,154 - INFO - Skipping layer model.layers.23.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:24:22,155 - INFO - Layer: model.layers.23.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:24:22,159 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_23_mlp_gate_proj.safetensors2025-04-25 10:24:22,159 - INFO - exists: True2025-04-25 10:24:22,199 - INFO - factorize_layer_kron_svd2025-04-25 10:24:24,112 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:24:25,742 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:24:27,522 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:24:30,494 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:24:35,418 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_23_mlp_gate_proj.safetensors TrueLayer: model.layers.23.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [6.1160230e-05 7.6930728e-06 3.0249867e-06 2.7455358e-06 8.7957324e-07]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:25:57,851 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:25:57,852 - INFO - Replacing 'model.layers.23.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  74%|███████████████████████████▎         | 166/225 [2:02:22<37:23, 38.02s/it]2025-04-25 10:25:57,852 - INFO - Layer: model.layers.23.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:25:57,858 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_23_mlp_up_proj.safetensors2025-04-25 10:25:57,858 - INFO - exists: True2025-04-25 10:25:57,914 - INFO - factorize_layer_kron_svd2025-04-25 10:26:00,045 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:26:01,747 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:26:03,631 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:26:07,183 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:26:12,140 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_23_mlp_up_proj.safetensors TrueLayer: model.layers.23.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.0700950e-05 1.0850087e-05 3.0478370e-06 2.7577860e-06 1.0493300e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:27:29,464 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:27:29,464 - INFO - Replacing 'model.layers.23.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  74%|███████████████████████████▍         | 167/225 [2:03:54<43:34, 45.07s/it]2025-04-25 10:27:29,464 - INFO - Layer: model.layers.23.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:27:29,468 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_23_mlp_down_proj.safetensors2025-04-25 10:27:29,468 - INFO - exists: True2025-04-25 10:27:29,521 - INFO - factorize_layer_kron_svd2025-04-25 10:27:33,524 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:27:37,920 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:27:42,527 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:27:44,205 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_23_mlp_down_proj.safetensors TrueLayer: model.layers.23.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.9849013e-04 1.3456233e-04 4.6011995e-05 2.5036485e-05 2.0889142e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:29:21,253 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:29:21,253 - INFO - Replacing 'model.layers.23.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  75%|███████████████████████████▋         | 168/225 [2:05:45<52:51, 55.64s/it]2025-04-25 10:29:21,254 - INFO - Skipping layer model.layers.24.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:29:21,254 - INFO - Skipping layer model.layers.24.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:29:21,254 - INFO - Skipping layer model.layers.24.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:29:21,254 - INFO - Skipping layer model.layers.24.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:29:21,254 - INFO - Layer: model.layers.24.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:29:21,258 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_24_mlp_gate_proj.safetensors2025-04-25 10:29:21,258 - INFO - exists: True2025-04-25 10:29:21,313 - INFO - factorize_layer_kron_svd2025-04-25 10:29:23,315 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:29:25,011 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:29:26,755 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:29:29,868 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:29:34,932 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_24_mlp_gate_proj.safetensors TrueLayer: model.layers.24.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [4.4121691e-05 1.3112597e-05 3.2457165e-06 2.4401338e-06 1.0232633e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:31:00,370 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:31:00,370 - INFO - Replacing 'model.layers.24.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  77%|████████████████████████████▍        | 173/225 [2:07:25<31:44, 36.63s/it]2025-04-25 10:31:00,371 - INFO - Layer: model.layers.24.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:31:00,375 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_24_mlp_up_proj.safetensors2025-04-25 10:31:00,375 - INFO - exists: True2025-04-25 10:31:00,428 - INFO - factorize_layer_kron_svd2025-04-25 10:31:02,439 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:31:04,134 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:31:05,985 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:31:09,136 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:31:14,245 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_24_mlp_up_proj.safetensors TrueLayer: model.layers.24.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.5628203e-05 5.7007760e-06 3.7646316e-06 2.6412245e-06 1.1728267e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:32:39,963 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:32:39,964 - INFO - Replacing 'model.layers.24.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  77%|████████████████████████████▌        | 174/225 [2:09:04<38:10, 44.92s/it]2025-04-25 10:32:39,964 - INFO - Layer: model.layers.24.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:32:39,968 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_24_mlp_down_proj.safetensors2025-04-25 10:32:39,968 - INFO - exists: True2025-04-25 10:32:40,023 - INFO - factorize_layer_kron_svd2025-04-25 10:32:45,062 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 10:32:46,745 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_24_mlp_down_proj.safetensors TrueLayer: model.layers.24.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [7.6039176e-04 1.1625126e-04 8.9553621e-05 6.9029913e-05 6.1117011e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:34:30,851 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:34:30,851 - INFO - Replacing 'model.layers.24.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  78%|████████████████████████████▊        | 175/225 [2:10:55<46:08, 55.36s/it]2025-04-25 10:34:30,852 - INFO - Skipping layer model.layers.25.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:34:30,852 - INFO - Skipping layer model.layers.25.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:34:30,852 - INFO - Skipping layer model.layers.25.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:34:30,852 - INFO - Skipping layer model.layers.25.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:34:30,852 - INFO - Layer: model.layers.25.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:34:30,856 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_25_mlp_gate_proj.safetensors2025-04-25 10:34:30,856 - INFO - exists: True2025-04-25 10:34:30,904 - INFO - factorize_layer_kron_svd2025-04-25 10:34:32,835 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:34:34,534 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:34:36,322 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:34:39,606 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:34:44,952 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_25_mlp_gate_proj.safetensors TrueLayer: model.layers.25.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [5.2119365e-05 1.5998443e-05 4.2028828e-06 1.9503250e-06 1.1962458e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:36:24,864 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:36:24,864 - INFO - Replacing 'model.layers.25.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  80%|█████████████████████████████▌       | 180/225 [2:12:49<28:33, 38.08s/it]2025-04-25 10:36:24,865 - INFO - Layer: model.layers.25.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:36:24,869 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_25_mlp_up_proj.safetensors2025-04-25 10:36:24,869 - INFO - exists: True2025-04-25 10:36:24,917 - INFO - factorize_layer_kron_svd2025-04-25 10:36:26,835 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:36:28,601 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:36:30,338 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:36:33,869 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:36:38,954 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_25_mlp_up_proj.safetensors TrueLayer: model.layers.25.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [3.1324049e-05 1.3509117e-05 3.6688416e-06 2.5376289e-06 1.6996275e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:38:08,557 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:38:08,558 - INFO - Replacing 'model.layers.25.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  80%|█████████████████████████████▊       | 181/225 [2:14:33<34:15, 46.72s/it]2025-04-25 10:38:08,558 - INFO - Layer: model.layers.25.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:38:08,562 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_25_mlp_down_proj.safetensors2025-04-25 10:38:08,562 - INFO - exists: True2025-04-25 10:38:08,611 - INFO - factorize_layer_kron_svd2025-04-25 10:38:13,739 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 10:38:15,568 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_25_mlp_down_proj.safetensors TrueLayer: model.layers.25.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [9.4778248e-04 8.1464685e-05 7.0380600e-05 5.4604279e-05 5.2647098e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:40:06,163 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:40:06,164 - INFO - Replacing 'model.layers.25.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  81%|█████████████████████████████▉       | 182/225 [2:16:30<41:31, 57.94s/it]2025-04-25 10:40:06,164 - INFO - Skipping layer model.layers.26.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:40:06,164 - INFO - Skipping layer model.layers.26.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:40:06,164 - INFO - Skipping layer model.layers.26.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:40:06,164 - INFO - Skipping layer model.layers.26.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:40:06,164 - INFO - Layer: model.layers.26.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:40:06,169 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_26_mlp_gate_proj.safetensors2025-04-25 10:40:06,169 - INFO - exists: True2025-04-25 10:40:06,207 - INFO - factorize_layer_kron_svd2025-04-25 10:40:08,060 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:40:09,519 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:40:10,965 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:40:12,414 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:40:13,852 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:40:15,535 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 10:40:17,788 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:40:20,581 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:40:23,088 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:40:25,637 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:40:28,503 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:40:33,269 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_26_mlp_gate_proj.safetensors TrueLayer: model.layers.26.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.1177969e-05 7.0294473e-06 5.6685963e-06 5.4653333e-06 5.2272426e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:41:54,949 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:41:54,950 - INFO - Replacing 'model.layers.26.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  83%|██████████████████████████████▊      | 187/225 [2:18:19<24:32, 38.74s/it]2025-04-25 10:41:54,950 - INFO - Layer: model.layers.26.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:41:54,953 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_26_mlp_up_proj.safetensors2025-04-25 10:41:54,954 - INFO - exists: True2025-04-25 10:41:54,998 - INFO - factorize_layer_kron_svd2025-04-25 10:41:56,788 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:41:58,306 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:41:59,832 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:42:01,303 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:42:02,775 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:42:04,583 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 10:42:06,865 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:42:09,410 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:42:11,849 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:42:14,305 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:42:16,916 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:42:21,936 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_26_mlp_up_proj.safetensors TrueLayer: model.layers.26.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [5.8573000e-06 4.1578205e-06 4.1114536e-06 4.0316727e-06 4.0044106e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:43:46,344 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:43:46,344 - INFO - Replacing 'model.layers.26.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  84%|██████████████████████████████▉      | 188/225 [2:20:11<29:47, 48.31s/it]2025-04-25 10:43:46,345 - INFO - Layer: model.layers.26.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:43:46,350 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_26_mlp_down_proj.safetensors2025-04-25 10:43:46,350 - INFO - exists: True2025-04-25 10:43:46,399 - INFO - factorize_layer_kron_svd2025-04-25 10:43:50,576 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:43:55,458 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 10:43:57,137 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_26_mlp_down_proj.safetensors TrueLayer: model.layers.26.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [9.3228667e-04 1.3390029e-04 7.0287591e-05 5.7642061e-05 5.4216205e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:45:45,252 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:45:45,253 - INFO - Replacing 'model.layers.26.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  84%|███████████████████████████████      | 189/225 [2:22:09<35:41, 59.48s/it]2025-04-25 10:45:45,253 - INFO - Skipping layer model.layers.27.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:45:45,253 - INFO - Skipping layer model.layers.27.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:45:45,253 - INFO - Skipping layer model.layers.27.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:45:45,253 - INFO - Skipping layer model.layers.27.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:45:45,253 - INFO - Layer: model.layers.27.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:45:45,256 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_27_mlp_gate_proj.safetensors2025-04-25 10:45:45,257 - INFO - exists: True2025-04-25 10:45:45,307 - INFO - factorize_layer_kron_svd2025-04-25 10:45:47,139 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:45:48,917 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 10:45:52,705 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:45:57,648 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_27_mlp_gate_proj.safetensors TrueLayer: model.layers.27.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.0092305e-04 2.1935584e-05 5.2262717e-06 4.0358891e-06 1.9398285e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:47:23,648 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:47:23,648 - INFO - Replacing 'model.layers.27.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  86%|███████████████████████████████▉     | 194/225 [2:23:48<19:49, 38.36s/it]2025-04-25 10:47:23,648 - INFO - Layer: model.layers.27.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:47:23,652 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_27_mlp_up_proj.safetensors2025-04-25 10:47:23,652 - INFO - exists: True2025-04-25 10:47:23,689 - INFO - factorize_layer_kron_svd2025-04-25 10:47:25,817 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 10:47:30,563 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_27_mlp_up_proj.safetensors TrueLayer: model.layers.27.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.3770806e-04 2.9873483e-05 9.9648341e-06 6.3683833e-06 5.0436934e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:49:01,372 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:49:01,372 - INFO - Replacing 'model.layers.27.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  87%|████████████████████████████████     | 195/225 [2:25:26<23:05, 46.18s/it]2025-04-25 10:49:01,373 - INFO - Layer: model.layers.27.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:49:01,376 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_27_mlp_down_proj.safetensors2025-04-25 10:49:01,376 - INFO - exists: True2025-04-25 10:49:01,426 - INFO - factorize_layer_kron_svd2025-04-25 10:49:04,795 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:49:09,281 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:49:13,932 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:49:15,633 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:49:17,330 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_27_mlp_down_proj.safetensors TrueLayer: model.layers.27.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.2940892e-03 1.0578800e-04 6.5972701e-05 6.0271639e-05 5.8059490e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:51:03,156 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:51:03,156 - INFO - Replacing 'model.layers.27.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  87%|████████████████████████████████▏    | 196/225 [2:27:27<28:06, 58.15s/it]2025-04-25 10:51:03,156 - INFO - Skipping layer model.layers.28.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:51:03,156 - INFO - Skipping layer model.layers.28.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:51:03,156 - INFO - Skipping layer model.layers.28.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:51:03,157 - INFO - Skipping layer model.layers.28.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:51:03,157 - INFO - Layer: model.layers.28.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:51:03,160 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_28_mlp_gate_proj.safetensors2025-04-25 10:51:03,160 - INFO - exists: True2025-04-25 10:51:03,228 - INFO - factorize_layer_kron_svd2025-04-25 10:51:05,141 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:51:06,646 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:51:08,082 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:51:09,531 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:51:10,975 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:51:12,648 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 10:51:14,857 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:51:17,395 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:51:20,025 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:51:22,539 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:51:25,297 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:51:30,241 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_28_mlp_gate_proj.safetensors TrueLayer: model.layers.28.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.1478479e-05 8.4232897e-06 6.2309559e-06 5.6626295e-06 5.4233547e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:52:56,749 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:52:56,749 - INFO - Replacing 'model.layers.28.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  89%|█████████████████████████████████    | 201/225 [2:29:21<15:44, 39.34s/it]2025-04-25 10:52:56,750 - INFO - Layer: model.layers.28.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:52:56,754 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_28_mlp_up_proj.safetensors2025-04-25 10:52:56,754 - INFO - exists: True2025-04-25 10:52:56,808 - INFO - factorize_layer_kron_svd2025-04-25 10:52:58,779 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:53:00,293 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:53:01,768 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:53:03,233 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:53:04,688 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:53:06,468 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 10:53:08,680 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:53:11,208 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:53:13,675 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:53:16,208 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:53:19,387 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:53:24,284 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_28_mlp_up_proj.safetensors TrueLayer: model.layers.28.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [9.0412914e-06 4.9462546e-06 4.5711072e-06 4.3498171e-06 4.2142728e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:54:51,453 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:54:51,453 - INFO - Replacing 'model.layers.28.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  90%|█████████████████████████████████▏   | 202/225 [2:31:16<18:53, 49.27s/it]2025-04-25 10:54:51,453 - INFO - Layer: model.layers.28.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:54:51,457 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_28_mlp_down_proj.safetensors2025-04-25 10:54:51,457 - INFO - exists: True2025-04-25 10:54:51,508 - INFO - factorize_layer_kron_svd2025-04-25 10:54:54,906 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:54:59,215 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:55:04,119 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 10:55:05,764 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:55:07,557 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_28_mlp_down_proj.safetensors TrueLayer: model.layers.28.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [2.2516120e-03 1.3546676e-04 1.0788906e-04 6.6894747e-05 6.0438753e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 10:56:53,354 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 10:56:53,354 - INFO - Replacing 'model.layers.28.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  90%|█████████████████████████████████▍   | 203/225 [2:33:18<22:16, 60.77s/it]2025-04-25 10:56:53,355 - INFO - Skipping layer model.layers.29.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:56:53,355 - INFO - Skipping layer model.layers.29.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:56:53,355 - INFO - Skipping layer model.layers.29.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:56:53,355 - INFO - Skipping layer model.layers.29.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 10:56:53,355 - INFO - Layer: model.layers.29.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:56:53,358 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_29_mlp_gate_proj.safetensors2025-04-25 10:56:53,358 - INFO - exists: True2025-04-25 10:56:53,405 - INFO - factorize_layer_kron_svd2025-04-25 10:56:55,187 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:56:56,668 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:56:58,171 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:56:59,699 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:57:01,166 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:57:02,869 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 10:57:05,089 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:57:07,710 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 10:57:10,167 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 10:57:12,676 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 10:57:15,188 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 10:57:20,134 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_29_mlp_gate_proj.safetensors TrueLayer: model.layers.29.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.2054783e-05 9.3067165e-06 6.6202938e-06 5.8108521e-06 5.6967979e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 10:58:48,353 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 10:58:48,353 - INFO - Replacing 'model.layers.29.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  92%|██████████████████████████████████▏  | 208/225 [2:35:13<11:32, 40.72s/it]2025-04-25 10:58:48,353 - INFO - Layer: model.layers.29.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 10:58:48,357 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_29_mlp_up_proj.safetensors2025-04-25 10:58:48,357 - INFO - exists: True2025-04-25 10:58:48,406 - INFO - factorize_layer_kron_svd2025-04-25 10:58:50,333 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:58:52,277 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 10:58:55,403 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 10:59:00,471 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_29_mlp_up_proj.safetensors TrueLayer: model.layers.29.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [7.6421385e-04 1.3142382e-05 2.9129556e-06 9.0123518e-07 6.0785652e-07]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 11:00:25,962 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 11:00:25,963 - INFO - Replacing 'model.layers.29.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  93%|██████████████████████████████████▎  | 209/225 [2:36:50<12:51, 48.21s/it]2025-04-25 11:00:25,963 - INFO - Layer: model.layers.29.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 11:00:25,966 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_29_mlp_down_proj.safetensors2025-04-25 11:00:25,966 - INFO - exists: True2025-04-25 11:00:26,010 - INFO - factorize_layer_kron_svd2025-04-25 11:00:29,365 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:00:34,026 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 11:00:39,102 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 11:00:40,702 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:00:42,530 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_29_mlp_down_proj.safetensors TrueLayer: model.layers.29.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.5448872e-03 1.8298271e-04 1.0788712e-04 8.9858280e-05 6.8271802e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 11:02:39,344 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 11:02:39,344 - INFO - Replacing 'model.layers.29.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  93%|██████████████████████████████████▌  | 210/225 [2:39:04<15:25, 61.70s/it]2025-04-25 11:02:39,345 - INFO - Skipping layer model.layers.30.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:02:39,345 - INFO - Skipping layer model.layers.30.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:02:39,345 - INFO - Skipping layer model.layers.30.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:02:39,345 - INFO - Skipping layer model.layers.30.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:02:39,345 - INFO - Layer: model.layers.30.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 11:02:39,348 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_30_mlp_gate_proj.safetensors2025-04-25 11:02:39,348 - INFO - exists: True2025-04-25 11:02:39,403 - INFO - factorize_layer_kron_svd2025-04-25 11:02:42,122 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:02:43,738 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 11:02:45,442 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 11:02:48,000 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:02:52,918 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_30_mlp_gate_proj.safetensors TrueLayer: model.layers.30.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [2.3446290e-03 2.7263601e-05 9.1192542e-06 8.4393541e-06 6.2888453e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 11:04:19,674 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 11:04:19,675 - INFO - Replacing 'model.layers.30.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  96%|███████████████████████████████████▎ | 215/225 [2:40:44<06:36, 39.60s/it]2025-04-25 11:04:19,675 - INFO - Layer: model.layers.30.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 11:04:19,679 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_30_mlp_up_proj.safetensors2025-04-25 11:04:19,679 - INFO - exists: True2025-04-25 11:04:19,727 - INFO - factorize_layer_kron_svd2025-04-25 11:04:22,411 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:04:24,037 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 11:04:25,791 - INFO -   Factor is positive definite (alpha=1.00e-03)2025-04-25 11:04:29,661 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:04:34,805 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_30_mlp_up_proj.safetensors TrueLayer: model.layers.30.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [7.2230742e-04 6.2582774e-05 2.0682110e-05 1.6292968e-05 1.3823622e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 11:06:02,360 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 11:06:02,361 - INFO - Replacing 'model.layers.30.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  96%|███████████████████████████████████▌ | 216/225 [2:42:27<07:11, 47.91s/it]2025-04-25 11:06:02,362 - INFO - Layer: model.layers.30.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 11:06:02,365 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_30_mlp_down_proj.safetensors2025-04-25 11:06:02,366 - INFO - exists: True2025-04-25 11:06:02,393 - INFO - factorize_layer_kron_svd2025-04-25 11:06:07,469 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:06:12,702 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 11:06:14,109 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:06:15,840 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 11:06:17,547 - INFO -   Factor is positive definite (alpha=1.00e-03)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_30_mlp_down_proj.safetensors TrueLayer: model.layers.30.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Factor is positive definite (alpha=1.00e-03)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [1.2465831e-02 1.2820089e-04 3.9151524e-05 3.0743769e-05 2.4599909e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 11:08:05,052 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 11:08:05,053 - INFO - Replacing 'model.layers.30.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers:  96%|███████████████████████████████████▋ | 217/225 [2:44:29<07:57, 59.75s/it]2025-04-25 11:08:05,054 - INFO - Skipping layer model.layers.31.self_attn.q_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:08:05,054 - INFO - Skipping layer model.layers.31.self_attn.k_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:08:05,054 - INFO - Skipping layer model.layers.31.self_attn.v_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:08:05,054 - INFO - Skipping layer model.layers.31.self_attn.o_proj: Sensitivity ratio >= 1.0 (1.00). No compression.2025-04-25 11:08:05,054 - INFO - Layer: model.layers.31.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 11:08:05,058 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_31_mlp_gate_proj.safetensors2025-04-25 11:08:05,058 - INFO - exists: True2025-04-25 11:08:05,085 - INFO - factorize_layer_kron_svd2025-04-25 11:08:07,893 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:08:09,639 - INFO -   Factor is positive definite (alpha=1.00e-04)2025-04-25 11:08:13,982 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:08:19,285 - INFO -   Factor is positive definite (alpha=1.00e-04)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_31_mlp_gate_proj.safetensors TrueLayer: model.layers.31.mlp.gate_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Regularizing factor (try 1, alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-04)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.1482296e-03 1.2643088e-04 6.4626453e-05 3.4475019e-05 2.4750701e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 11:09:46,146 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 11:09:46,147 - INFO - Replacing 'model.layers.31.mlp.gate_proj' (attribute 'gate_proj' within parent LlamaMLP)Compressing Layers:  99%|████████████████████████████████████▌| 222/225 [2:46:10<01:56, 38.77s/it]2025-04-25 11:09:46,147 - INFO - Layer: model.layers.31.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 11:09:46,150 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_31_mlp_up_proj.safetensors2025-04-25 11:09:46,150 - INFO - exists: True2025-04-25 11:09:46,176 - INFO - factorize_layer_kron_svd2025-04-25 11:09:49,061 - INFO -   Factor is positive definite (alpha=1.00e-05)2025-04-25 11:09:53,738 - INFO -   Factor is positive definite (alpha=1.00e-05)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_31_mlp_up_proj.safetensors TrueLayer: model.layers.31.mlp.up_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Factor is positive definite (alpha=1.00e-05)  Factor is positive definite (alpha=1.00e-05)  Cholesky decomposition successful.  Performing SVD on transformed matrix (11008x4096)...  SVD complete. Singular values (top 5): [1.3142769e-03 2.3480139e-04 1.5099822e-04 1.1153698e-04 9.4178453e-05]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,4096), (11008,2096)factorized_sequential Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))2025-04-25 11:11:20,455 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=4096, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=11008, bias=False))')2025-04-25 11:11:20,455 - INFO - Replacing 'model.layers.31.mlp.up_proj' (attribute 'up_proj' within parent LlamaMLP)Compressing Layers:  99%|████████████████████████████████████▋| 223/225 [2:47:45<01:32, 46.08s/it]2025-04-25 11:11:20,456 - INFO - Layer: model.layers.31.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)2025-04-25 11:11:20,498 - INFO - factor_filename: /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_31_mlp_down_proj.safetensors2025-04-25 11:11:20,498 - INFO - exists: True2025-04-25 11:11:20,533 - INFO - factorize_layer_kron_svd2025-04-25 11:11:24,011 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:11:26,482 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 11:11:28,881 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 11:11:31,260 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 11:11:33,669 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 11:11:38,549 - INFO -   Factor is positive definite (alpha=1.00e+00)2025-04-25 11:11:39,951 - INFO -   Regularizing factor (try 1, alpha=1.00e-05)2025-04-25 11:11:41,377 - INFO -   Regularizing factor (try 2, alpha=1.00e-04)2025-04-25 11:11:42,801 - INFO -   Regularizing factor (try 3, alpha=1.00e-03)2025-04-25 11:11:44,213 - INFO -   Regularizing factor (try 4, alpha=1.00e-02)2025-04-25 11:11:45,635 - INFO -   Regularizing factor (try 5, alpha=1.00e-01)2025-04-25 11:11:47,345 - INFO -   Factor is positive definite (alpha=1.00e+00)factor_filename /home/jovyan/shares/SR004.nfs2/chekalina/FisherKronecker/grads_output/llama-2-7b/fisher_factors_output_1404/model_layers_31_mlp_down_proj.safetensors TrueLayer: model.layers.31.mlp.down_proj | Ratio: 0.800 -> Target Rank: 2096 (Align: 8)factorize_layer_kron_svdRegularizing factors for layer (initial alpha=1.00e-05)...  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Regularizing factor (try 1, alpha=1.00e-05)  Regularizing factor (try 2, alpha=1.00e-04)  Regularizing factor (try 3, alpha=1.00e-03)  Regularizing factor (try 4, alpha=1.00e-02)  Regularizing factor (try 5, alpha=1.00e-01)  Factor is positive definite (alpha=1.00e+00)  Cholesky decomposition successful.  Performing SVD on transformed matrix (4096x11008)...  SVD complete. Singular values (top 5): [7.8325793e-06 6.5032355e-06 6.0197217e-06 5.8576052e-06 5.3895933e-06]  Cholesky factor inverses computed.  Factorization complete for layer. New shapes: (2096,11008), (4096,2096)factorized_sequential Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))2025-04-25 11:13:35,333 - INFO - factorized_sequential 'Sequential(  (0): Linear(in_features=11008, out_features=2096, bias=False)  (1): Linear(in_features=2096, out_features=4096, bias=False))')2025-04-25 11:13:35,333 - INFO - Replacing 'model.layers.31.mlp.down_proj' (attribute 'down_proj' within parent LlamaMLP)Compressing Layers: 100%|████████████████████████████████████▊| 224/225 [2:50:00<01:00, 60.14s/it]2025-04-25 11:13:35,334 - INFO - Skipping layer lm_head: Sensitivity ratio >= 1.0 (1.00). No compression.Compressing Layers: 100%|█████████████████████████████████████| 225/225 [2:50:00<00:00, 45.33s/it]2025-04-25 11:13:35,334 - INFO - Compression finished. Processed: 96, Skipped (Ratio>=1 or No Sensitivity/Factors): 129, Failed: 02025-04-25 11:13:35,334 - INFO - Saving compressed model to ./llama102025-04-25 11:14:04,230 - INFO - Compressed model and tokenizer saved.2025-04-25 11:14:04,257 - INFO - Evaluating on wikitext2Evaluating:   0%|                                                          | 0/21 [00:00<?, ?it/s]Evaluating:   5%|██▍                                               | 1/21 [00:01<00:36,  1.80s/it]Evaluating:  10%|████▊                                             | 2/21 [00:02<00:25,  1.35s/it]Evaluating:  14%|███████▏                                          | 3/21 [00:03<00:21,  1.22s/it]Evaluating:  19%|█████████▌                                        | 4/21 [00:04<00:19,  1.15s/it]Evaluating:  24%|███████████▉                                      | 5/21 [00:05<00:17,  1.11s/it]Evaluating:  29%|██████████████▎                                   | 6/21 [00:07<00:16,  1.09s/it]Evaluating:  33%|████████████████▋                                 | 7/21 [00:08<00:15,  1.08s/it]Evaluating:  38%|███████████████████                               | 8/21 [00:09<00:13,  1.07s/it]Evaluating:  43%|█████████████████████▍                            | 9/21 [00:10<00:12,  1.06s/it]Evaluating:  48%|███████████████████████▎                         | 10/21 [00:11<00:11,  1.06s/it]Evaluating:  52%|█████████████████████████▋                       | 11/21 [00:12<00:10,  1.06s/it]Evaluating:  57%|████████████████████████████                     | 12/21 [00:13<00:09,  1.06s/it]Evaluating:  62%|██████████████████████████████▎                  | 13/21 [00:14<00:08,  1.06s/it]Evaluating:  67%|████████████████████████████████▋                | 14/21 [00:15<00:07,  1.05s/it]Evaluating:  71%|███████████████████████████████████              | 15/21 [00:16<00:06,  1.05s/it]Evaluating:  76%|█████████████████████████████████████▎           | 16/21 [00:17<00:05,  1.05s/it]Evaluating:  81%|███████████████████████████████████████▋         | 17/21 [00:18<00:04,  1.05s/it]Evaluating:  86%|██████████████████████████████████████████       | 18/21 [00:19<00:03,  1.05s/it]Evaluating:  90%|████████████████████████████████████████████▎    | 19/21 [00:20<00:02,  1.07s/it]Evaluating:  95%|██████████████████████████████████████████████▋  | 20/21 [00:21<00:01,  1.06s/it]Evaluating: 100%|█████████████████████████████████████████████████| 21/21 [00:22<00:00,  1.01it/s]Evaluating: 100%|█████████████████████████████████████████████████| 21/21 [00:22<00:00,  1.08s/it]2025-04-25 11:14:34,793 - INFO - wikitext2 perplexity: 152576.00002025-04-25 11:14:34,793 - INFO - Evaluating on ptbnlls.shape torch.Size([16376])Mean NLL: 11.9375Evaluating:   0%|                                                           | 0/7 [00:00<?, ?it/s]Evaluating:  14%|███████▎                                           | 1/7 [00:01<00:06,  1.06s/it]Evaluating:  29%|██████████████▌                                    | 2/7 [00:02<00:05,  1.06s/it]Evaluating:  43%|█████████████████████▊                             | 3/7 [00:03<00:04,  1.05s/it]Evaluating:  57%|█████████████████████████████▏                     | 4/7 [00:04<00:03,  1.05s/it]Evaluating:  71%|████████████████████████████████████▍              | 5/7 [00:05<00:02,  1.05s/it]Evaluating:  86%|███████████████████████████████████████████▋       | 6/7 [00:06<00:01,  1.05s/it]Evaluating: 100%|███████████████████████████████████████████████████| 7/7 [00:07<00:00,  1.01s/it]Evaluating: 100%|███████████████████████████████████████████████████| 7/7 [00:07<00:00,  1.04s/it]2025-04-25 11:14:44,612 - INFO - ptb perplexity: 143360.00002025-04-25 11:14:44,613 - INFO - Evaluation results:2025-04-25 11:14:44,613 - INFO -   wikitext2: 152576.00002025-04-25 11:14:44,613 - INFO -   ptb: 143360.0000nlls.shape torch.Size([16376])Mean NLL: 11.875